<div layout="column">

    <div layout="row" flex>
        <div layout="column" flex="20">
            <div layout="column" layout-padding>
                <span>Tipo de Gráfica</span>
                <md-select ng-model="ctrl.type">
                    <md-option value="{{type}}" ng-repeat="type in ctrl.charttypes">{{type | translate}}</md-option>
                </md-select>
            </div>
            <div layout="column" layout-padding>
                <span>Eje X</span>
                <md-select ng-model="ctrl.x" placeholder="Variable" ng-change="ctrl.proccessData()">
                    <md-option ng-repeat='f in ctrl.entity.fields' value="{{f.name}}">{{f.name | translate}}</md-option>
                </md-select>
                <md-checkbox ng-model="ctrl.grouped" ng-change="ctrl.proccessData()">Agrupar</md-checkbox>
                <md-select ng-if="ctrl.grouped" ng-model="ctrl.grouptype" ng-change="ctrl.proccessData()">
                    <md-option value="none">-</md-option>
                    <md-option value="day">día</md-option>
                    <md-option value="month">mes</md-option>
                    <md-option value="year">año</md-option>
                </md-select>
                <md-checkbox ng-model="ctrl.sum" ng-if="ctrl.grouped" ng-change="ctrl.proccessData()">Sumar Valores</md-checkbox>
            </div>
            <div layout="column" layout-padding>
                <span>Series</span>
                <md-select multiple="true" ng-model="ctrl.series" placeholder="Variable" ng-change="ctrl.proccessData()">
                    <md-option ng-if="f.name != ctrl.x" ng-repeat='f in ctrl.entity.fields' value="{{f.name}}">{{f.name | translate}}</md-option>
                </md-select>
            </div>
        </div>
        <div layout="column" flex>
            <div layout="column" layout-padding>
                <div layout="row" flex>
                    <span flex>Filtrar Data</span>
                    <span flex></span>
                    <md-select ng-model="ctrl.page.entity" ng-change="ctrl.init()" flex>
                        <md-option ng-repeat="(key, entity) in ctrl.entities" value="{{key}}">{{key | translate}}</md-option>
                    </md-select>
                </div>
                <div layout="row" flex layout-align="space-around">
                    <md-select ng-repeat='f in ctrl.entity.fields' ng-if="f.type == 'link'" multiple="true" ng-model="ctrl.query.filters[f.name]"
                        placeholder="{{f.name | translate}}" ng-change="ctrl.getData()">
                        <md-option ng-repeat="o in ctrl.options[f.name]" value="{{o[f.foreign_key]}}">{{o[f.foreign_name]}}</md-option>
                    </md-select>
                </div>
            </div>
            <canvas id="base" class="chart-base" chart-type="ctrl.type" chart-data="ctrl.data" chart-labels="ctrl.labels" chart-series="ctrl.series"
                chart-click="ctrl.onClick">
            </canvas>
        </div>
    </div>
</div>